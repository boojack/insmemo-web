var Pe=Object.defineProperty,Qe=Object.defineProperties;var $e=Object.getOwnPropertyDescriptors;var xe=Object.getOwnPropertySymbols;var qe=Object.prototype.hasOwnProperty,Ge=Object.prototype.propertyIsEnumerable;var de=(n,e,a)=>e in n?Pe(n,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):n[e]=a,x=(n,e)=>{for(var a in e||(e={}))qe.call(e,a)&&de(n,a,e[a]);if(xe)for(var a of xe(e))Ge.call(e,a)&&de(n,a,e[a]);return n},F=(n,e)=>Qe(n,$e(e));var B=(n,e,a)=>(de(n,typeof e!="symbol"?e+"":e,a),a);import{j as me,r as l,R as ae,t as He,a as be,T as je,b as Ve}from"./vendor.6869b499.js";const We=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function a(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerpolicy&&(i.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?i.credentials="include":r.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(r){if(r.ep)return;r.ep=!0;const i=a(r);fetch(r.href,i)}};We();const t=me.exports.jsx,c=me.exports.jsxs,O=me.exports.Fragment,ve=n=>{const{children:e,store:a,context:s}=n,[r,i]=l.exports.useState(a.getState());return l.exports.useEffect(()=>{const o=a.subscribe(u=>{i(u)});return()=>{o()}},[]),t(s.Provider,{value:r,children:e})};function Ye(n){const e=Object.keys(n),a={};for(const s of e)typeof n[s]=="function"&&(a[s]=n[s]);return(s={},r)=>{let i=!1;const o={};for(const u of e){const p=s[u],E=a[u](p,r);o[u]=E,i=i||E!==p}return i?o:s}}function Ke(n,e){const a=[];let s=n;return{dispatch:u=>{const p=e(s,u),E=s;s=p;for(const N of a)N(s,E)},getState:()=>s,subscribe:u=>{let p=!0;return a.push(u),()=>{if(!p)return;const E=a.indexOf(u);a.splice(E,1),p=!1}}}}function ze(n,e){switch(e.type){case"SET_MARK_MEMO_ID":return e.payload.markMemoId===n.markMemoId?n:F(x({},n),{markMemoId:e.payload.markMemoId});case"SET_EDIT_MEMO_ID":return e.payload.editMemoId===n.editMemoId?n:F(x({},n),{editMemoId:e.payload.editMemoId});case"SET_MOBILE_VIEW":return e.payload.isMobileView===n.isMobileView?n:F(x({},n),{isMobileView:e.payload.isMobileView});case"SET_APP_SETTING":return x(x({},n),e.payload);default:return n}}const Je={markMemoId:"",editMemoId:"",shouldSplitMemoWord:!0,shouldHideImageUrl:!0,shouldUseMarkdownParser:!0,isMobileView:!1};function Xe(n,e){switch(e.type){case"SET_LOCATION":return e.payload;case"SET_PATHNAME":return e.payload.pathname===n.pathname?n:F(x({},n),{pathname:e.payload.pathname});case"SET_HASH":return e.payload.hash===n.hash?n:F(x({},n),{hash:e.payload.hash});case"SET_QUERY":return F(x({},n),{query:x({},e.payload)});case"SET_TAG_QUERY":return e.payload.tag===n.query.tag?n:F(x({},n),{query:F(x({},n.query),{tag:e.payload.tag})});case"SET_DURATION_QUERY":return e.payload.duration===n.query.duration?n:F(x({},n),{query:F(x({},n.query),{duration:x(x({},n.query.duration),e.payload.duration)})});case"SET_TYPE":return e.payload.type===n.query.type?n:F(x({},n),{query:F(x({},n.query),{type:e.payload.type})});case"SET_TEXT":return e.payload.text===n.query.text?n:F(x({},n),{query:F(x({},n.query),{text:e.payload.text})});case"SET_QUERY_FILTER":return e.payload===n.query.filter?n:F(x({},n),{query:F(x({},n.query),{filter:e.payload})});default:return n}}const Ze={pathname:"/",hash:"",query:{tag:"",duration:null,type:"",text:"",filter:""}};var pe;(function(n){function e(){return Date.now()}n.getNowTimeStamp=e;function a(){const f=navigator.userAgent;let C="Unknown";return f.indexOf("Win")!=-1?C="Windows":f.indexOf("Mac")!=-1?C="MacOS":f.indexOf("Linux")!=-1&&(C="Linux"),C}n.getOSVersion=a;function s(f){return typeof f=="string"&&(f=f.replaceAll("-","/")),new Date(f).getTime()}n.getTimeStampByDate=s;function r(f){const C=new Date(s(f));return new Date(C.getFullYear(),C.getMonth(),C.getDate()).getTime()}n.getDateStampByDate=r;function i(f){const C=new Date(s(f)),v=C.getFullYear(),D=C.getMonth()+1,k=C.getDate();return`${v}/${D}/${k}`}n.getDateString=i;function o(f){const C=new Date(s(f)),v=C.getHours(),D=C.getMinutes(),k=v<10?"0"+v:v,U=D<10?"0"+D:D;return`${k}:${U}`}n.getTimeString=o;function u(f){const C=new Date(s(f)),v=C.getFullYear(),D=C.getMonth()+1,k=C.getDate(),U=C.getHours(),j=C.getMinutes(),M=C.getSeconds(),G=D<10?"0"+D:D,ne=k<10?"0"+k:k,ue=U<10?"0"+U:U,Ue=j<10?"0"+j:j,Re=M<10?"0"+M:M;return`${v}/${G}/${ne} ${ue}:${Ue}:${Re}`}n.getDateTimeString=u;function p(f){return Array.from(new Set(f))}n.dedupe=p;function E(f){const C=new Set,v=[];for(const D of f)C.has(D.id)||(C.add(D.id),v.push(D));return v}n.dedupeObjectWithId=E;function N(f,C){let v=null;return()=>{v&&clearTimeout(v),v=setTimeout(f,C)}}n.debounce=N;function h(f,C){let v=!0;return()=>{if(!v)return!1;v=!1,setTimeout(()=>{f(),v=!0},C)}}n.throttle=h;function m(f){const C=[],v=Object.keys(f).sort();for(const D of v){const k=f[D];k&&(typeof k=="object"?C.push(...m(k).split("&")):C.push(`${D}=${k}`))}return C.join("&")}n.transformObjectToParamsString=m;function d(f){const C={},v=f.split("&");for(const D of v){const[k,U]=D.split("=");k&&U&&(C[k]=U)}return C}n.transformParamsStringToObject=d;function y(f){if(!f)return{};const C={},v=Object.keys(f).sort();for(const D of v){const k=f[D];if(typeof k=="object"){const U=y(JSON.parse(JSON.stringify(k)));U&&Object.keys(U).length>0&&(C[D]=U)}else Boolean(k)&&(C[D]=k)}return C}n.filterObjectNullKeys=y;async function g(f){if(navigator.clipboard&&navigator.clipboard.writeText)try{await navigator.clipboard.writeText(f)}catch(C){console.warn("Copy to clipboard failed.",C)}else console.warn("Copy to clipboard failed, methods not supports.")}n.copyTextToClipboard=g;function S(f){return new Promise(C=>{const v=new Image;v.onload=()=>{const{width:D,height:k}=v;D>0&&k>0?C({width:D,height:k}):C({width:0,height:0})},v.onerror=()=>{C({width:0,height:0})},v.className="hidden",v.src=f,document.body.appendChild(v),v.remove()})}n.getImageSize=S})(pe||(pe={}));var b=pe;function et(n,e){switch(e.type){case"SET_MEMOS":{const a=b.dedupeObjectWithId(e.payload.memos.sort((s,r)=>b.getTimeStampByDate(r.createdAt)-b.getTimeStampByDate(s.createdAt)));return F(x({},n),{memos:[...a]})}case"SET_TAGS":return F(x({},n),{tags:e.payload.tags});case"INSERT_MEMO":{const a=b.dedupeObjectWithId([e.payload.memo,...n.memos].sort((s,r)=>b.getTimeStampByDate(r.createdAt)-b.getTimeStampByDate(s.createdAt)));return F(x({},n),{memos:a})}case"DELETE_MEMO_BY_ID":return F(x({},n),{memos:[...n.memos].filter(a=>a.id!==e.payload.id)});case"EDIT_MEMO":{const a=n.memos.map(s=>s.id===e.payload.id?x(x({},s),e.payload):s);return F(x({},n),{memos:a})}default:return n}}const tt={memos:[],tags:[]};function nt(n,e){switch(e.type){case"SIGN_IN":return{user:e.payload.user};case"SIGN_OUT":return{user:null};default:return n}}const at={user:null};function st(n,e){switch(e.type){case"SET_QUERIES":{const a=b.dedupeObjectWithId(e.payload.queries.sort((s,r)=>b.getTimeStampByDate(r.createdAt)-b.getTimeStampByDate(s.createdAt)).sort((s,r)=>{var i,o;return b.getTimeStampByDate((i=r.pinnedAt)!=null?i:0)-b.getTimeStampByDate((o=s.pinnedAt)!=null?o:0)}));return F(x({},n),{queries:a})}case"INSERT_QUERY":{const a=b.dedupeObjectWithId([e.payload.query,...n.queries].sort((s,r)=>b.getTimeStampByDate(r.createdAt)-b.getTimeStampByDate(s.createdAt)));return F(x({},n),{queries:a})}case"DELETE_QUERY_BY_ID":return F(x({},n),{queries:[...n.queries].filter(a=>a.id!==e.payload.id)});case"UPDATE_QUERY":{const a=n.queries.map(s=>s.id===e.payload.id?x(x({},s),e.payload):s);return F(x({},n),{queries:a})}default:return n}}const rt={queries:[]},T=Ke({globalState:Je,locationState:Ze,memoState:tt,userState:at,queryState:rt},Ye({globalState:ze,locationState:Xe,memoState:et,userState:nt,queryState:st})),R=l.exports.createContext(T.getState());var Y;(function(n){function e(i){const o={};for(const u of i)try{const p=localStorage.getItem(u);if(p!==null){const E=JSON.parse(p);o[u]=E}}catch(p){console.error("Get storage failed in ",u,p)}return o}n.get=e;function a(i){for(const o in i)try{const u=JSON.stringify(i[o]);localStorage.setItem(o,u)}catch(u){console.error("Save storage failed in ",o,u)}}n.set=a;function s(i){for(const o of i)try{localStorage.removeItem(o)}catch(u){console.error("Remove storage failed in ",o,u)}}n.remove=s;function r(){var o;const i=document.createElement("iframe");i.style.display="none",document.body.appendChild(i),(o=i.contentWindow)==null||o.localStorage.setItem("t",Date.now().toString()),i.remove()}n.emitStorageChangedEvent=r})(Y||(Y={}));class ot{constructor(){B(this,"getState",()=>T.getState().globalState);B(this,"setEditMemoId",e=>{T.dispatch({type:"SET_EDIT_MEMO_ID",payload:{editMemoId:e}})});B(this,"setMarkMemoId",e=>{T.dispatch({type:"SET_MARK_MEMO_ID",payload:{markMemoId:e}})});B(this,"setIsMobileView",e=>{T.dispatch({type:"SET_MOBILE_VIEW",payload:{isMobileView:e}})});B(this,"setAppSetting",e=>{T.dispatch({type:"SET_APP_SETTING",payload:e}),Y.set(e)});var s,r,i;const e=Y.get(["shouldSplitMemoWord","shouldHideImageUrl","shouldUseMarkdownParser"]),a={shouldSplitMemoWord:(s=e.shouldSplitMemoWord)!=null?s:!0,shouldHideImageUrl:(r=e.shouldHideImageUrl)!=null?r:!0,shouldUseMarkdownParser:(i=e.shouldUseMarkdownParser)!=null?i:!0};this.setAppSetting(a)}}const Q=new ot,H=(n="replace")=>{const{query:e,pathname:a,hash:s}=T.getState().locationState;let r=b.transformObjectToParamsString(e);r?r="?"+r:r="",n==="replace"?window.history.replaceState(null,"",a+s+r):window.history.pushState(null,"",a+s+r)};class ct{constructor(){B(this,"updateStateWithLocation",()=>{var p,E,N,h,m,d;const{pathname:e,search:a,hash:s}=window.location,r=new URLSearchParams(a),i={pathname:"/",hash:"",query:{tag:"",duration:null,text:"",type:"",filter:""}};i.query.tag=(p=r.get("tag"))!=null?p:"",i.query.type=(E=r.get("type"))!=null?E:"",i.query.text=(N=r.get("text"))!=null?N:"",i.query.filter=(h=r.get("filter"))!=null?h:"";const o=parseInt((m=r.get("from"))!=null?m:"0"),u=parseInt((d=r.get("to"))!=null?d:"0");u>o&&u!==0&&(i.query.duration={from:o,to:u}),i.hash=s,i.pathname=this.getValidPathname(e),T.dispatch({type:"SET_LOCATION",payload:i})});B(this,"getState",()=>T.getState().locationState);B(this,"clearQuery",()=>{T.dispatch({type:"SET_QUERY",payload:{tag:"",duration:null,text:"",type:"",filter:""}}),H()});B(this,"setQuery",e=>{T.dispatch({type:"SET_QUERY",payload:e}),H()});B(this,"setHash",e=>{T.dispatch({type:"SET_HASH",payload:{hash:e}}),H()});B(this,"setPathname",e=>{T.dispatch({type:"SET_PATHNAME",payload:{pathname:e}}),H()});B(this,"pushHistory",e=>{T.dispatch({type:"SET_PATHNAME",payload:{pathname:e}}),H("push")});B(this,"replaceHistory",e=>{T.dispatch({type:"SET_PATHNAME",payload:{pathname:e}}),H("replace")});B(this,"setMemoTypeQuery",(e="")=>{T.dispatch({type:"SET_TYPE",payload:{type:e}}),H()});B(this,"setMemoFilter",e=>{T.dispatch({type:"SET_QUERY_FILTER",payload:e}),H()});B(this,"setTextQuery",e=>{T.dispatch({type:"SET_TEXT",payload:{text:e}}),H()});B(this,"setTagQuery",e=>{T.dispatch({type:"SET_TAG_QUERY",payload:{tag:e}}),H()});B(this,"setFromAndToQuery",(e,a)=>{T.dispatch({type:"SET_DURATION_QUERY",payload:{duration:{from:e,to:a}}}),H()});B(this,"getValidPathname",e=>["/","/signin","/recycle","/setting"].includes(e)?e:"/");this.updateStateWithLocation(),window.onpopstate=()=>{this.updateStateWithLocation()}}}const A=new ct;async function J(n){const a=await(await fetch(n,{method:"GET"})).json();if(!a.succeed)throw a;return a}async function P(n,e){const s=await(await fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();if(!s.succeed)throw s;return s}var he;(function(n){function e(){return J("/api/user/me")}n.getUserInfo=e;function a(M,G){return P("/api/user/signin",{username:M,password:G})}n.signin=a;function s(M,G){return P("/api/user/signup",{username:M,password:G})}n.signup=s;function r(){return P("/api/user/signout")}n.signout=r;function i(M){return J("/api/user/checkusername?username="+M)}n.checkUsernameUsable=i;function o(M){return P("/api/user/checkpassword",{password:M})}n.checkPasswordValid=o;function u(M,G,ne,ue){return P("/api/user/update",{username:M,password:G,githubName:ne,wxUserId:ue})}n.updateUserinfo=u;function p(){return J("/api/memo/all")}n.getMyMemos=p;function E(){return J("/api/memo/deleted")}n.getMyDeletedMemos=E;function N(M){return P("/api/memo/new",{content:M})}n.createMemo=N;function h(M){return J("/api/memo/?id="+M)}n.getMemoById=h;function m(M){return P("/api/memo/hide",{memoId:M})}n.hideMemo=m;function d(M){return P("/api/memo/restore",{memoId:M})}n.restoreMemo=d;function y(M){return P("/api/memo/delete",{memoId:M})}n.deleteMemo=y;function g(M,G){return P("/api/memo/update",{memoId:M,content:G})}n.updateMemo=g;function S(M){return J("/api/memo/linked?memoId="+M)}n.getLinkedMemos=S;function f(){return P("/api/user/updategh",{githubName:""})}n.removeGithubName=f;function C(){return J("/api/query/all")}n.getMyQueries=C;function v(M,G){return P("/api/query/new",{title:M,querystring:G})}n.createQuery=v;function D(M,G,ne){return P("/api/query/update",{queryId:M,title:G,querystring:ne})}n.updateQuery=D;function k(M){return P("/api/query/delete",{queryId:M})}n.deleteQueryById=k;function U(M){return P("/api/query/pin",{queryId:M})}n.pinQuery=U;function j(M){return P("/api/query/unpin",{queryId:M})}n.unpinQuery=j})(he||(he={}));var L=he;const se="#page-wrapper",re="mobile-show-sidebar",De=200,it=400,V=3600*24*1e3,X=/#\s(.+?)\s/g,ie=/(https?:\/\/[^\s<\\*>']+)/g,W=/(https?:\/\/[^\s<\\*>']+\.(jpeg|jpg|gif|png|svg))/g,oe=/\[@(.+?)\]\((.+?)\)/g;class lt{getState(){return T.getState().userState}async doSignIn(){const{data:e}=await L.getUserInfo();return e?T.dispatch({type:"SIGN_IN",payload:{user:e}}):_.doSignOut(),e}async doSignOut(){L.signout().catch(()=>{}).finally(()=>{T.dispatch({type:"SIGN_OUT",payload:null})})}async checkUsernameUsable(e){const{data:a}=await L.checkUsernameUsable(e);return a}async updateUsername(e){await L.updateUserinfo(e)}async removeGithubName(){await L.updateUserinfo(void 0,void 0,"")}async checkPasswordValid(e){const{data:a}=await L.checkPasswordValid(e);return a}async updatePassword(e){await L.updateUserinfo(void 0,e)}async updateWxUserId(e){await L.updateUserinfo(void 0,void 0,void 0,e)}}const _=new lt;class ut{constructor(){B(this,"initialized",!1)}getState(){return T.getState().memoState}async fetchAllMemos(){if(!_.getState().user)return!1;const{data:e}=await L.getMyMemos(),a=[];for(const s of e)a.push(s);return T.dispatch({type:"SET_MEMOS",payload:{memos:a}}),this.initialized||(this.initialized=!0),a}async fetchDeletedMemos(){if(!_.getState().user)return!1;const{data:e}=await L.getMyDeletedMemos();return e}pushMemo(e){T.dispatch({type:"INSERT_MEMO",payload:{memo:x({},e)}})}getMemoById(e){for(const a of this.getState().memos)if(a.id===e)return a;return null}async hideMemoById(e){await L.hideMemo(e),T.dispatch({type:"DELETE_MEMO_BY_ID",payload:{id:e}})}async restoreMemoById(e){await L.restoreMemo(e),I.clearMemos(),I.fetchAllMemos()}async deleteMemoById(e){await L.deleteMemo(e)}editMemo(e){T.dispatch({type:"EDIT_MEMO",payload:e})}updateTagsState(){var s;const{memos:e}=this.getState(),a=new Set;for(const r of e)for(const i of Array.from((s=r.content.match(X))!=null?s:[]))a.add(i.replace(X,"$1").trim());T.dispatch({type:"SET_TAGS",payload:{tags:Array.from(a)}})}clearMemos(){T.dispatch({type:"SET_MEMOS",payload:{memos:[]}})}async createMemo(e){const{data:a}=await L.createMemo(e);return a}async updateMemo(e,a){const{data:s}=await L.updateMemo(e,a);return s}async getLinkedMemos(e){const{data:a}=await L.getLinkedMemos(e);return a}}const I=new ut;class dt{getState(){return T.getState().queryState}async getMyAllQueries(){if(!_.getState().user)return!1;const{data:e}=await L.getMyQueries();return T.dispatch({type:"SET_QUERIES",payload:{queries:e}}),e}getQueryById(e){for(const a of this.getState().queries)if(a.id===e)return a}pushQuery(e){T.dispatch({type:"INSERT_QUERY",payload:{query:x({},e)}})}editQuery(e){T.dispatch({type:"UPDATE_QUERY",payload:e})}async deleteQuery(e){await L.deleteQueryById(e),T.dispatch({type:"DELETE_QUERY_BY_ID",payload:{id:e}})}async createQuery(e,a){const{data:s}=await L.createQuery(e,a);return s}async updateQuery(e,a,s){const{data:r}=await L.updateQuery(e,a,s);return r}async pinQuery(e){await L.pinQuery(e)}async unpinQuery(e){await L.unpinQuery(e)}}const $=new dt,mt=n=>{const{children:e,when:a}=n;return a?t(O,{children:e}):null},q=mt;const pt=n=>{const{children:e,className:a,clickSpaceDestroy:s,destroy:r}=n,i=()=>{s&&r()};return t("div",{className:`dialog-wrapper ${a}`,onClick:i,children:t("div",{className:"dialog-container",onClick:o=>o.stopPropagation(),children:e})})};function K(n,e,a){const s=document.createElement("div");document.body.append(s),setTimeout(()=>{var u;(u=s.firstElementChild)==null||u.classList.add("showup")},0);const r={destroy:()=>{var u,p;(u=s.firstElementChild)==null||u.classList.remove("showup"),(p=s.firstElementChild)==null||p.classList.add("showoff"),setTimeout(()=>{s.remove(),ae.unmountComponentAtNode(s)},De)}},i=F(x({},a),{destroy:r.destroy});let o=t(pt,F(x({destroy:r.destroy,clickSpaceDestroy:!0},n),{children:t(e,x({},i))}));return n.useAppContext&&(o=t(ve,{store:T,context:R,children:o})),ae.render(o,s),r}const ht=({destroy:n})=>c(O,{children:[c("div",{className:"dialog-header-container",children:[c("p",{className:"title-text",children:[t("span",{className:"icon-text",children:"\u{1F920}"}),"\u5173\u4E8E ",t("b",{children:"Memos"})]}),t("button",{className:"btn close-btn",onClick:()=>{n()},children:t("img",{className:"icon-img",src:"/icons/close.svg"})})]}),c("div",{className:"dialog-content-container",children:[t("p",{children:"\u4E00\u4E2A\u788E\u7247\u5316\u77E5\u8BC6\u8BB0\u5F55\u5DE5\u5177\u3002"}),t("br",{}),t("i",{children:"\u4E3A\u4F55\u505A\u8FD9\u4E2A\uFF1F"}),c("ul",{children:[c("li",{children:["\u5B9E\u8DF5 ",t("strong",{children:"\u5362\u66FC\u5361\u7247\u76D2\u7B14\u8BB0\u6CD5"}),"\uFF1B"]}),t("li",{children:"\u7528\u4E8E\u8BB0\u5F55\uFF1A\u{1F4C5} \u6BCF\u65E5/\u5468\u8BA1\u5212\u3001\u{1F4A1} \u7A81\u53D1\u5947\u60F3\u3001\u{1F4D5} \u8BFB\u540E\u611F..."}),t("li",{children:"\u4EE3\u66FF\u4E86\u6211\u5728\u5FAE\u4FE1\u4E0A\u7ECF\u5E38\u4F7F\u7528\u7684\u201C\u6587\u4EF6\u4F20\u8F93\u52A9\u624B\u201D\uFF1B"}),t("li",{children:"\u6253\u9020\u4E00\u4E2A\u5C5E\u4E8E\u81EA\u5DF1\u7684\u8F7B\u91CF\u5316\u201C\u5361\u7247\u201D\u7B14\u8BB0\u7C3F\uFF1B"})]}),t("br",{}),t("i",{children:"\u6709\u4F55\u7279\u70B9\u5462\uFF1F"}),c("ul",{children:[c("li",{children:["\u2728"," ",t("a",{target:"_blank",href:"https://github.com/boojack/insmemo-web",rel:"noreferrer",children:"\u5F00\u6E90\u9879\u76EE"})]}),t("li",{children:"\u{1F60B} \u7CBE\u7F8E\u4E14\u7EC6\u8282\u7684\u89C6\u89C9\u6837\u5F0F\uFF1B"}),t("li",{children:"\u{1F4D1} \u4F53\u9A8C\u4F18\u826F\u7684\u4EA4\u4E92\u903B\u8F91\uFF1B"})]}),t("br",{}),t("a",{target:"_blank",href:"https://github.com/boojack/insmemo-web/discussions",rel:"noreferrer",children:"\u{1F914} \u95EE\u9898\u53CD\u9988"}),t("br",{}),t("p",{children:"Enjoy it and have fun~ "}),t("hr",{}),c("p",{className:"normal-text",children:["Last updated on ",t("span",{className:"pre-text",children:"2021/11/15 12:57:20"})," \u{1F389}"]})]})]});function Fe(){K({className:"about-site-dialog"},ht)}const gt=n=>{const{shownStatus:e,setShownStatus:a}=n,s=l.exports.useRef(null);l.exports.useEffect(()=>{if(e){const p=E=>{var N;((N=s.current)==null?void 0:N.contains(E.target))||E.stopPropagation(),a(!1)};window.addEventListener("click",p,{capture:!0,once:!0})}},[e]);const r=()=>{A.pushHistory("/setting")},i=()=>{A.pushHistory("/recycle")},o=()=>{Fe()},u=async()=>{await _.doSignOut(),A.replaceHistory("/signin")};return c("div",{className:`menu-btns-popup ${e?"":"hidden"}`,ref:s,children:[c("button",{className:"btn action-btn",onClick:r,children:[t("span",{className:"icon",children:"\u{1F464}"})," \u8D26\u53F7\u4E0E\u8BBE\u7F6E"]}),c("button",{className:"btn action-btn",onClick:i,children:[t("span",{className:"icon",children:"\u{1F5D1}\uFE0F"})," \u56DE\u6536\u7AD9"]}),c("button",{className:"btn action-btn",onClick:o,children:[t("span",{className:"icon",children:"\u{1F920}"})," \u5173\u4E8E"]}),c("button",{className:"btn action-btn",onClick:u,children:[t("span",{className:"icon",children:"\u{1F44B}"})," \u9000\u51FA"]})]})};function Z(n=!1){const[e,a]=l.exports.useState(n),s=l.exports.useCallback(r=>{a(r!==void 0?r:i=>!i)},[]);return[e,s]}function ee(n=!0){const[e,a]=l.exports.useState({isLoading:n,isFailed:!1,isSucceed:!1});return F(x({},e),{setLoading:()=>{a(F(x({},e),{isLoading:!0,isFailed:!1,isSucceed:!1}))},setFinish:()=>{a(F(x({},e),{isLoading:!1,isFailed:!1,isSucceed:!0}))},setError:()=>{a(F(x({},e),{isLoading:!1,isFailed:!0,isSucceed:!1}))}})}const ft=({destroy:n,imgUrl:e})=>{const a=l.exports.useRef(null),[s,r]=l.exports.useState(-1);l.exports.useEffect(()=>{b.getImageSize(e).then(({width:p})=>{r(p!==0?80:0)})},[]);const i=()=>{n()},o=()=>{s>30&&r(s-10)},u=()=>{r(s+10)};return c(O,{children:[t("button",{className:"btn close-btn",onClick:i,children:t("img",{className:"icon-img",src:"/icons/close.svg"})}),c("div",{className:"img-container",children:[t("img",{className:s<=0?"hidden":"",ref:a,width:s+"%",src:e}),t("span",{className:"loading-text "+(s===-1?"":"hidden"),children:"\u56FE\u7247\u52A0\u8F7D\u4E2D..."}),t("span",{className:"loading-text "+(s===0?"":"hidden"),children:"\u{1F61F} \u56FE\u7247\u52A0\u8F7D\u5931\u8D25\uFF0C\u53EF\u80FD\u662F\u65E0\u6548\u7684\u94FE\u63A5"})]}),c("div",{className:"action-btns-container",children:[t("button",{className:"btn",onClick:o,children:"\u2796"}),t("button",{className:"btn",onClick:u,children:"\u2795"}),t("button",{className:"btn",onClick:()=>r(80),children:"\u2B55"})]})]})};function we(n){K({className:"preview-image-dialog"},ft,{imgUrl:n})}const yt=/```([\s\S]*?)```/g,Nt=/\*\*(.+?)\*\*/g,Et=/\*(.+?)\*/g,Ct=/\[ \] /g,St=/\[x\] /g,xt=/[*] /g,bt=/(\d+)\. /g,vt=n=>n.replace(yt,"<pre lang=''>$1</pre>").replace(xt,"<span class='counter-block'>\u2022</span>").replace(bt,"<span class='counter-block'>$1.</span>").replace(Ct,"<span class='todo-block' data-type='todo'>\u2B1C</span>").replace(St,"<span class='todo-block' data-type='done'>\u2705</span>").replace(Nt,"<strong>$1</strong>").replace(Et,"<em>$1</em>"),ge=n=>{const e=document.createElement("div");return e.className="memo-content-text",e.innerHTML=n,e.innerText},Dt=n=>n.replace(/\n/g,"<br>"),Ft=n=>{const e=document.createElement("div");return e.textContent=n,e.innerHTML};const fe=n=>{const{className:e,imgUrl:a}=n,s=()=>{we(a)};return t("div",{className:"image-container "+e,onClick:s,children:t("img",{src:a,decoding:"async",loading:"lazy"})})};const wt=n=>{const{destory:e,duration:a}=n;return l.exports.useEffect(()=>{a>0&&setTimeout(()=>{e()},a)},[]),t("div",{className:"toast-container",onClick:e,children:t("p",{className:"content-text",children:n.content})})};class Mt{constructor(){B(this,"shownToastAmount",0);B(this,"toastWrapper");B(this,"shownToastContainers",[]);B(this,"info",(e,a=3e3)=>this.showToast({type:"normal",content:e,duration:a}));B(this,"success",(e,a=3e3)=>this.showToast({type:"success",content:e,duration:a}));B(this,"error",(e,a=3e3)=>this.showToast({type:"error",content:e,duration:a}));B(this,"showToast",e=>{const a=document.createElement("div");a.className=`toast-wrapper ${e.type}`,this.toastWrapper.appendChild(a),this.shownToastAmount++,this.shownToastContainers.push(a),setTimeout(()=>{a.classList.add("showup")},0);const s={destory:()=>{a.classList.add("destory"),setTimeout(()=>{if(!!a.parentElement&&(this.shownToastAmount--,this.shownToastAmount===0)){for(const r of this.shownToastContainers)ae.unmountComponentAtNode(r),r.remove();this.shownToastContainers.splice(0,this.shownToastContainers.length)}},it)}};return ae.render(t(wt,F(x({},e),{destory:s.destory})),a),s});const e="toast-list-container",a=document.createElement("div");a.className=e,document.body.appendChild(a),this.toastWrapper=a}}const w=new Mt;const Tt=n=>{var h;const[e,a]=l.exports.useState(F(x({},n.memo),{createdAtStr:b.getDateTimeString(n.memo.createdAt)})),[s,r]=l.exports.useState([]),[i,o]=l.exports.useState([]),u=Array.from((h=e.content.match(W))!=null?h:[]);l.exports.useEffect(()=>{(async()=>{try{const d=[],y=[...e.content.matchAll(oe)];for(const S of y)if(S&&S.length===3){const f=S[2],C=I.getMemoById(f);C&&d.push(F(x({},C),{createdAtStr:b.getDateTimeString(C.createdAt),dateStr:b.getDateString(C.createdAt)}))}r([...d]);const g=await I.getLinkedMemos(e.id);o(g.sort((S,f)=>b.getTimeStampByDate(f.createdAt)-b.getTimeStampByDate(S.createdAt)).map(S=>F(x({},S),{createdAtStr:b.getDateTimeString(S.createdAt),dateStr:b.getDateString(S.createdAt)})))}catch{}})()},[e.id]);const p=l.exports.useCallback(async m=>{var y;const d=m.target;if(d.className==="memo-link-text"){const g=(y=d.dataset)==null?void 0:y.value,S=I.getMemoById(g!=null?g:"");if(S){const f=F(x({},S),{createdAtStr:b.getDateTimeString(S.createdAt)});r([]),o([]),a(f)}else w.error("MEMO Not Found"),d.classList.remove("memo-link-text")}},[]),E=l.exports.useCallback(m=>{r([]),o([]),a(m)},[]),N=l.exports.useCallback(()=>{n.destroy(),Q.setEditMemoId(e.id)},[e.id]);return c(O,{children:[c("div",{className:"memo-card-container",children:[c("div",{className:"header-container",children:[t("p",{className:"time-text",children:e.createdAtStr}),c("div",{className:"btns-container",children:[t("button",{className:"btn edit-btn",onClick:N,children:t("img",{className:"icon-img",src:"/icons/edit.svg"})}),t("button",{className:"btn close-btn",onClick:n.destroy,children:t("img",{className:"icon-img",src:"/icons/close.svg"})})]})]}),c("div",{className:"memo-container",children:[t("div",{className:"memo-content-text",onClick:p,dangerouslySetInnerHTML:{__html:z(e.content)}}),t(q,{when:u.length>0,children:t("div",{className:"images-wrapper",children:u.map((m,d)=>t(fe,{className:"memo-img",imgUrl:m},d))})})]}),t("div",{className:"layer-container"}),s.map((m,d)=>d<4?t("div",{className:"background-layer-container",style:{bottom:(d+1)*-3+"px",left:(d+1)*5+"px",width:`calc(100% - ${(d+1)*10}px)`,zIndex:-d-1}},d):null)]}),s.length>0?c("div",{className:"linked-memos-wrapper",children:[c("p",{className:"normal-text",children:["\u5173\u8054\u4E86 ",s.length," \u4E2A MEMO"]}),s.map(m=>{const d=ge(z(m.content)).replaceAll(`
`," ");return c("div",{className:"linked-memo-container",onClick:()=>E(m),children:[c("span",{className:"time-text",children:[m.dateStr," "]}),d]},m.id)})]}):null,i.length>0?c("div",{className:"linked-memos-wrapper",children:[c("p",{className:"normal-text",children:[i.length," \u4E2A\u94FE\u63A5\u81F3\u6B64\u7684 MEMO"]}),i.map(m=>{const d=ge(z(m.content)).replaceAll(`
`," ");return c("div",{className:"linked-memo-container",onClick:()=>E(m),children:[c("span",{className:"time-text",children:[m.dateStr," "]}),d]},m.id)})]}):null]})};function Me(n){K({className:"memo-card-dialog"},Tt,{memo:n})}const kt=n=>{var d;const{memo:e,destroy:a}=n,{user:s}=_.getState(),r=F(x({},e),{createdAtStr:b.getDateTimeString(e.createdAt)}),i=Array.from((d=r.content.match(W))!=null?d:[]),[o,u]=l.exports.useState(""),[p,E]=l.exports.useState(i.length),N=l.exports.useRef(null);l.exports.useEffect(()=>{p>0||setTimeout(()=>{He(N.current,{backgroundColor:"#f8f8f8",cacheBust:!0,pixelRatio:4}).then(y=>{u(y),be(N.current,{backgroundColor:"#f8f8f8",cacheBust:!0,pixelRatio:4}).then(g=>{u(g)})})},De+100)},[p]);const h=()=>{a()},m=y=>{y.type==="error"&&(w.error("\u6709\u4E2A\u56FE\u7247\u52A0\u8F7D\u5931\u8D25\u4E86\u{1F61F}"),y.target.remove()),E(p-1)};return c(O,{children:[c("div",{className:"dialog-header-container",children:[c("p",{className:"title-text",children:[t("span",{className:"icon-text",children:"\u{1F970}"}),"\u5206\u4EAB Memo \u56FE\u7247"]}),t("button",{className:"btn close-btn",onClick:h,children:t("img",{className:"icon-img",src:"/icons/close.svg"})})]}),c("div",{className:"dialog-content-container",children:[t("div",{className:`tip-words-container ${o?"finish":"loading"}`,children:t("p",{className:"tip-text",children:o?"\u53F3\u952E\u6216\u957F\u6309\u5373\u53EF\u4FDD\u5B58\u56FE\u7247 \u{1F447}":"\u56FE\u7247\u751F\u6210\u4E2D..."})}),c("div",{className:"memo-container",ref:N,children:[t("img",{className:`memo-shortcut-img ${o?"":"hidden"}`,src:o}),t("span",{className:"time-text",children:r.createdAtStr}),t("div",{className:"memo-content-text",dangerouslySetInnerHTML:{__html:z(r.content)}}),t(q,{when:i.length>0,children:t("div",{className:"images-container",children:i.map((y,g)=>t("img",{crossOrigin:"anonymous",decoding:"async",src:y,onLoad:m,onError:m},g))})}),t("div",{className:"watermark-container",children:c("span",{className:"normal-text",children:["\u270D\uFE0F Memo by ",t("span",{className:"name-text",children:s==null?void 0:s.username})]})})]})]})]})};function At(n){K({className:"share-memo-image-dialog"},kt,{memo:n})}const Bt=n=>{var d;const{memo:e}=n,a=F(x({},e),{createdAtStr:b.getDateTimeString(e.createdAt)}),[s,r]=Z(!1),i=Array.from((d=a.content.match(W))!=null?d:[]),o=()=>{Me(a)},u=()=>{Q.setMarkMemoId(a.id)},p=()=>{Q.setEditMemoId(a.id)},E=async()=>{if(s){try{await I.hideMemoById(a.id)}catch(y){w.error(y.message)}Q.getState().editMemoId===a.id&&Q.setEditMemoId("")}else r()},N=()=>{s&&r(!1)},h=()=>{At(a)},m=async y=>{var S;const g=y.target;if(g.className==="memo-link-text"){const f=(S=g.dataset)==null?void 0:S.value,C=I.getMemoById(f!=null?f:"");C?Me(C):(w.error("MEMO Not Found"),g.classList.remove("memo-link-text"))}else g.className==="todo-block"};return c("div",{className:`memo-wrapper ${"memos-"+a.id}`,onMouseLeave:N,children:[c("div",{className:"memo-top-wrapper",children:[t("span",{className:"time-text",onClick:o,children:a.createdAtStr}),c("div",{className:"btns-container",children:[t("span",{className:"btn more-action-btn",children:t("img",{className:"icon-img",src:"/icons/more.svg"})}),t("div",{className:"more-action-btns-wrapper",children:c("div",{className:"more-action-btns-container",children:[t("span",{className:"btn",onClick:o,children:"\u67E5\u770B\u8BE6\u60C5"}),t("span",{className:"btn",onClick:u,children:"Mark"}),t("span",{className:"btn",onClick:h,children:"\u5206\u4EAB"}),t("span",{className:"btn",onClick:p,children:"\u7F16\u8F91"}),t("span",{className:`btn delete-btn ${s?"final-confirm":""}`,onClick:E,children:s?"\u786E\u5B9A\u5220\u9664\uFF01":"\u5220\u9664"})]})})]})]}),t("div",{className:"memo-content-text",onClick:m,dangerouslySetInnerHTML:{__html:z(a.content)}}),t(q,{when:i.length>0,children:t("div",{className:"images-wrapper",children:i.map((y,g)=>t(fe,{className:"memo-img",imgUrl:y},g))})})]})};function z(n){var i;n=Ft(n),n=Dt(n).split("<br>").map(o=>`<p>${o!==""?o:"<br>"}</p>`).join("");const{shouldUseMarkdownParser:e,shouldSplitMemoWord:a,shouldHideImageUrl:s}=Q.getState();e&&(n=vt(n)),s&&(n=n.replace(W,"")),a&&(n=n.replace(/([\u4e00-\u9fa5])([A-Za-z0-9?.,;[\]]+)/g,"$1 $2").replace(/([A-Za-z0-9?.,;[\]]+)([\u4e00-\u9fa5])/g,"$1 $2")),n=n.replace(X,"<span class='tag-span'>#$1</span>").replace(ie,"<a class='link' target='_blank' rel='noreferrer' href='$1'>$1</a>").replace(oe,"<span class='memo-link-text' data-value='$2'>$1</span>");const r=document.createElement("div");r.innerHTML=n;for(let o=0;o<r.children.length;o++){const u=r.children[o];if(u.tagName==="P"&&u.textContent===""&&((i=u.firstElementChild)==null?void 0:i.tagName)!=="BR"){u.remove(),o--;continue}}return r.innerHTML}var It=l.exports.memo(Bt);const Ot=n=>{var r;const{memo:e}=n,a=F(x({},e),{createdAtStr:b.getDateTimeString(e.createdAt),timeStr:b.getTimeString(e.createdAt)}),s=Array.from((r=a.content.match(W))!=null?r:[]);return c("div",{className:"daily-memo-wrapper",children:[t("div",{className:"time-wrapper",children:t("span",{className:"normal-text",children:a.timeStr})}),c("div",{className:"memo-content-container",children:[t("div",{className:"memo-content-text",dangerouslySetInnerHTML:{__html:z(a.content)}}),t(q,{when:s.length>0,children:t("div",{className:"images-container",children:s.map((i,o)=>t("img",{crossOrigin:"anonymous",src:i,decoding:"async"},o))})})]})]})};const Lt=n=>{const{className:e,datestamp:a,handleDateStampChange:s}=n,[r,i]=l.exports.useState(ye(a));l.exports.useEffect(()=>{i(ye(a))},[a]);const o=new Date(r),u=o.getDay()===0?7:o.getDay(),p=[];for(let m=1;m<u;m++)p.push({date:0,datestamp:o.getTime()-V*(7-m)});const E=_t(r);for(let m=1;m<=E;m++)p.push({date:m,datestamp:o.getTime()+V*(m-1)});const N=m=>{s(m)},h=m=>{const d=o.getFullYear(),y=o.getMonth()+1;let g=0;y===1&&m===-1?g=new Date(`${d-1}/12/1`).getTime():y===12&&m===1?g=new Date(`${d+1}/1/1`).getTime():g=new Date(`${d}/${y+m}/1`).getTime(),i(ye(g))};return c("div",{className:`date-picker-wrapper ${e}`,children:[c("div",{className:"date-picker-header",children:[t("span",{className:"btn-text",onClick:()=>h(-1),children:t("img",{className:"icon-img",src:"/icons/arrow-left.svg"})}),c("span",{className:"normal-text",children:[o.getFullYear()," \u5E74 ",o.getMonth()+1," \u6708"]}),t("span",{className:"btn-text",onClick:()=>h(1),children:t("img",{className:"icon-img",src:"/icons/arrow-right.svg"})})]}),c("div",{className:"date-picker-day-container",children:[c("div",{className:"date-picker-day-header",children:[t("span",{className:"day-item",children:"\u5468\u4E00"}),t("span",{className:"day-item",children:"\u5468\u4E8C"}),t("span",{className:"day-item",children:"\u5468\u4E09"}),t("span",{className:"day-item",children:"\u5468\u56DB"}),t("span",{className:"day-item",children:"\u5468\u4E94"}),t("span",{className:"day-item",children:"\u5468\u516D"}),t("span",{className:"day-item",children:"\u5468\u65E5"})]}),p.map(m=>m.date===0?t("span",{className:"day-item null",children:""},m.datestamp):t("span",{className:`day-item ${m.datestamp===a?"current":""}`,onClick:()=>N(m.datestamp),children:m.date},m.datestamp))]})]})};function _t(n){const e=new Date(n),a=new Date(`${e.getFullYear()}/${e.getMonth()+1}/1`);return((a.getMonth()===11?new Date(`${a.getFullYear()+1}/1`):new Date(`${a.getFullYear()}/${a.getMonth()+2}/1`)).getTime()-a.getTime())/V}function ye(n){const e=new Date(n);return new Date(`${e.getFullYear()}/${e.getMonth()+1}/1`).getTime()}const Ut=["\u4E00\u6708","\u4E8C\u6708","\u4E09\u6708","\u56DB\u6708","\u4E94\u6708","\u516D\u6708","\u4E03\u6708","\u516B\u6708","\u4E5D\u6708","\u5341\u6708","\u5341\u4E00\u6708","\u5341\u4E8C\u6708"],Rt=["\u5468\u65E5","\u5468\u4E00","\u5468\u4E8C","\u5468\u4E09","\u5468\u56DB","\u5468\u4E94","\u5468\u516D"],Pt=n=>{const e=ee(),[a,s]=l.exports.useState([]),[r,i]=l.exports.useState(b.getDateStampByDate(b.getDateString(n.currentDateStamp))),[o,u]=Z(!1),p=l.exports.useRef(null),E=new Date(r);l.exports.useEffect(()=>{(()=>{const d=I.getState().memos.filter(y=>b.getTimeStampByDate(y.createdAt)>=r&&b.getTimeStampByDate(y.createdAt)<r+V).sort((y,g)=>b.getTimeStampByDate(y.createdAt)-b.getTimeStampByDate(g.createdAt));s(d),e.setFinish()})()},[r]);const N=()=>{u(!1),setTimeout(()=>{!p.current||be(p.current,{backgroundColor:"#fff",cacheBust:!0,pixelRatio:4}).then(m=>{we(m)})},0)},h=m=>{i(m),u(!1)};return c(O,{children:[t("div",{className:"dialog-header-container",children:c("div",{className:"header-wrapper",children:[t("p",{className:"title-text",children:"Daily Memos"}),c("div",{className:"btns-container",children:[t("span",{className:"btn-text",onClick:()=>i(r-V),children:t("img",{className:"icon-img",src:"/icons/arrow-left.svg"})}),t("span",{className:"btn-text",onClick:()=>i(r+V),children:t("img",{className:"icon-img",src:"/icons/arrow-right.svg"})}),t("span",{className:"btn-text share-btn",onClick:N,children:t("img",{className:"icon-img",src:"/icons/share.svg"})}),t("span",{className:"btn-text",onClick:()=>n.destroy(),children:t("img",{className:"icon-img",src:"/icons/close.svg"})})]})]})}),c("div",{className:"dialog-content-container",ref:p,children:[c("div",{className:"date-card-container",onClick:()=>u(),children:[t("div",{className:"year-text",children:E.getFullYear()}),c("div",{className:"date-container",children:[t("div",{className:"month-text",children:Ut[E.getMonth()]}),t("div",{className:"date-text",children:E.getDate()}),t("div",{className:"day-text",children:Rt[E.getDay()]})]})]}),t(Lt,{className:`date-picker ${o?"":"hide"}`,datestamp:r,handleDateStampChange:h}),e.isLoading?t("div",{className:"tip-container",children:t("p",{className:"tip-text",children:"\u52AA\u529B\u52A0\u8F7D\u4E2D..."})}):a.length===0?t("div",{className:"tip-container",children:t("p",{className:"tip-text",children:"\u7A7A\u7A7A\u5982\u4E5F"})}):t("div",{className:"dailymemos-wrapper",children:a.map(m=>t(Ot,{memo:m},`${m.id}-${m.updatedAt}`))})]})]})};function Qt(n=Date.now()){K({className:"daily-memo-diary-dialog"},Pt,{currentDateStamp:n})}const $t=()=>{const{memoState:{memos:n,tags:e},globalState:{isMobileView:a},userState:{user:s}}=l.exports.useContext(R),r=s?s.username:"Memos",i=s?Math.ceil((Date.now()-b.getTimeStampByDate(s.createdAt))/1e3/3600/24):0,[o,u]=l.exports.useState(!1),p=l.exports.useCallback(()=>{A.pushHistory("/"),A.clearQuery()},[]);return c("div",{className:"user-banner-container",children:[c("div",{className:"userinfo-header-container",children:[t("p",{className:"username-text",onClick:p,children:r}),t("span",{className:"action-btn menu-popup-btn",onClick:()=>{const h=document.querySelector(".sidebar-wrapper"),m=document.querySelector(".menu-btns-popup");m.style.top=54-h.scrollTop+"px",u(!0)},children:t("img",{src:"/icons/more.svg",className:"icon-img"})}),t(q,{when:a,children:t("span",{className:"action-btn hide-sidebar-btn",onClick:()=>{const h=document.querySelector(se);h==null||h.classList.remove(re)},children:t("img",{src:"/icons/close.svg",className:"icon-img"})})}),t(gt,{shownStatus:o,setShownStatus:u})]}),c("div",{className:"status-text-container",children:[c("div",{className:"status-text memos-text",children:[t("span",{className:"amount-text",children:n.length}),t("span",{className:"type-text",children:"MEMO"})]}),c("div",{className:"status-text tags-text",children:[t("span",{className:"amount-text",children:e.length}),t("span",{className:"type-text",children:"TAG"})]}),c("div",{className:"status-text duration-text",onClick:()=>Qt(),children:[t("span",{className:"amount-text",children:i}),t("span",{className:"type-text",children:"DAY"})]})]})]})},qt=[{text:"\u4E14",value:"AND"},{text:"\u6216",value:"OR"}],te={TAG:{value:"TAG",text:"\u6807\u7B7E",operators:[{text:"\u5305\u62EC",value:"CONTAIN"},{text:"\u6392\u9664",value:"NOT_CONTAIN"}]},TYPE:{value:"TYPE",text:"\u7C7B\u578B",operators:[{value:"IS",text:"\u662F"},{value:"IS_NOT",text:"\u4E0D\u662F"}],values:[{value:"CONNECTED",text:"\u6709\u5173\u8054"},{value:"NOT_TAGGED",text:"\u65E0\u6807\u7B7E"},{value:"LINKED",text:"\u6709\u8D85\u94FE\u63A5"},{value:"IMAGED",text:"\u6709\u56FE\u7247"}]},TEXT:{value:"TEXT",text:"\u6587\u672C",operators:[{value:"CONTAIN",text:"\u5305\u62EC"},{value:"NOT_CONTAIN",text:"\u6392\u9664"}]}},Ne=te.TYPE.values,Gt=n=>{for(const e of Ne)if(e.value===n)return e.text;return""},Ht=()=>({type:"TAG",value:{operator:"CONTAIN",value:""},relation:"AND"}),Ee=(n,e)=>{let a=!0;for(const s of e){const{relation:r}=s,i=jt(n,s);r==="OR"?a=a||i:a=a&&i}return a},jt=(n,e)=>{const{type:a,value:{operator:s,value:r}}=e;if(r==="")return!0;let i=!0;if(a==="TAG"){let o=n.content.includes(`# ${r}`);s==="NOT_CONTAIN"&&(o=!o),i=o}else if(a==="TYPE"){let o=!1;(r==="NOT_TAGGED"&&n.content.match(X)===null||r==="LINKED"&&n.content.match(ie)!==null||r==="IMAGED"&&n.content.match(W)!==null||r==="CONNECTED"&&n.content.match(oe)!==null)&&(o=!0),s==="IS_NOT"&&(o=!o),i=o}else if(a==="TEXT"){let o=n.content.includes(r);s==="NOT_CONTAIN"&&(o=!o),i=o}return i};const Vt={text:"\u8BF7\u9009\u62E9",value:""},Wt=n=>{const{className:e,dataSource:a,handleValueChanged:s,value:r}=n,[i,o]=Z(!1),u=l.exports.useRef(null);let p=Vt;for(const h of a)if(h.value===r){p=h;break}l.exports.useEffect(()=>{if(i){const h=m=>{var d;((d=u.current)==null?void 0:d.contains(m.target))||o(!1)};window.addEventListener("click",h,{capture:!0,once:!0})}},[i]);const E=h=>{s&&s(h.value),o(!1)},N=h=>{h.stopPropagation(),o()};return c("div",{className:`selector-wrapper ${e!=null?e:""}`,ref:u,children:[c("div",{className:`current-value-container ${i?"active":""}`,onClick:N,children:[t("span",{className:"value-text",children:p.text}),t("span",{className:"arrow-text",children:t("img",{className:"icon-img",src:"/icons/arrow-right.svg"})})]}),t("div",{className:`items-wrapper ${i?"":"hidden"}`,children:a.map(h=>t("div",{className:`item-container ${h.value===r?"selected":""}`,onClick:()=>{E(h)},children:h.text},h.value))})]})};var ce=l.exports.memo(Wt);const Yt=n=>{const{destroy:e,queryId:a}=n,[s,r]=l.exports.useState(""),[i,o]=l.exports.useState([]),u=ee(!1),p=I.getState().memos.filter(y=>Ee(y,i)).length;l.exports.useEffect(()=>{const y=$.getQueryById(a!=null?a:"");if(y){r(y.title);const g=JSON.parse(y.querystring);Array.isArray(g)&&o(g)}},[a]);const E=y=>{const g=y.target.value;r(g)},N=async()=>{if(!s){w.error("\u6807\u9898\u4E0D\u80FD\u4E3A\u7A7A\uFF01");return}try{if(a){const y=await $.updateQuery(a,s,JSON.stringify(i));$.editQuery(y)}else{const y=await $.createQuery(s,JSON.stringify(i));$.pushQuery(y)}}catch(y){w.error(y.message)}e()},h=()=>{if(i.length>0&&i[i.length-1].value.value===""){w.info("\u5148\u5B8C\u5584\u4E0A\u4E00\u4E2A\u8FC7\u6EE4\u5668\u5427");return}o([...i,Ht()])},m=l.exports.useCallback((y,g)=>{o(S=>{const f=[...S];return f[y]=g,f})},[]),d=l.exports.useCallback(y=>{o(g=>g.filter((f,C)=>C!==y))},[]);return c(O,{children:[c("div",{className:"dialog-header-container",children:[c("p",{className:"title-text",children:[t("span",{className:"icon-text",children:"\u{1F516}"}),a?"\u7F16\u8F91\u68C0\u7D22":"\u521B\u5EFA\u68C0\u7D22"]}),t("button",{className:"btn close-btn",onClick:e,children:t("img",{className:"icon-img",src:"/icons/close.svg"})})]}),c("div",{className:"dialog-content-container",children:[c("div",{className:"form-item-container input-form-container",children:[t("span",{className:"normal-text",children:"\u6807\u9898"}),t("input",{className:"title-input",type:"text",value:s,onChange:E})]}),c("div",{className:"form-item-container filter-form-container",children:[t("span",{className:"normal-text",children:"\u8FC7\u6EE4\u5668"}),c("div",{className:"filters-wrapper",children:[i.map((y,g)=>t(Kt,{index:g,filter:y,handleFilterChange:m,handleFilterRemove:d},g)),t("div",{className:"create-filter-btn",onClick:h,children:"\u6DFB\u52A0\u7B5B\u9009\u6761\u4EF6"})]})]})]}),c("div",{className:"dialog-footer-container",children:[t("div",{}),c("div",{className:"btns-container",children:[c("span",{className:`tip-text ${i.length===0&&"hidden"}`,children:["\u7B26\u5408\u6761\u4EF6\u7684 Memo \u6709 ",t("strong",{children:p})," \u6761"]}),t("button",{className:`btn save-btn ${u.isLoading?"requesting":""}`,onClick:N,children:"\u4FDD\u5B58"})]})]})]})},Kt=l.exports.memo(n=>{const{index:e,filter:a,handleFilterChange:s,handleFilterRemove:r}=n,{type:i}=a,[o,u]=l.exports.useState(t(O,{}));l.exports.useEffect(()=>{let d=t(O,{});Object.keys(te).includes(i)&&(d=t(ce,{className:"operator-selector",dataSource:Object.values(te[i].operators),value:a.value.operator,handleValueChanged:N}));let y=t(O,{});switch(i){case"TYPE":{y=t(ce,{className:"value-selector",dataSource:te.TYPE.values,value:a.value.value,handleValueChanged:h});break}case"TAG":{y=t(ce,{className:"value-selector",dataSource:I.getState().tags.sort().map(g=>({text:g,value:g})),value:a.value.value,handleValueChanged:h});break}case"TEXT":{y=t("input",{type:"text",className:"value-inputer",value:a.value.value,onChange:g=>{h(g.target.value),g.target.focus()}});break}}u(c(O,{children:[d,y]}))},[i,a]);const p=l.exports.useCallback(d=>{["AND","OR"].includes(d)&&s(e,F(x({},a),{relation:d}))},[a]),E=l.exports.useCallback(d=>{if(a.type!==d){const y=Object.values(te[d].operators);s(e,F(x({},a),{type:d,value:{operator:y[0].value,value:""}}))}},[a]),N=l.exports.useCallback(d=>{s(e,F(x({},a),{value:F(x({},a.value),{operator:d})}))},[a]),h=l.exports.useCallback(d=>{s(e,F(x({},a),{value:F(x({},a.value),{value:d})}))},[a]),m=()=>{r(e)};return c("div",{className:"memo-filter-input-wrapper",children:[e>0?t(ce,{className:"relation-selector",dataSource:qt,value:a.relation,handleValueChanged:p}):null,t(ce,{className:"type-selector",dataSource:Object.values(te),value:a.type,handleValueChanged:E}),o,t("img",{className:"remove-btn",src:"/icons/close.svg",onClick:m})]})});function Ce(n){K({className:"create-query-dialog"},Yt,{queryId:n})}const zt=()=>{const{queryState:{queries:n},locationState:{query:{filter:e}}}=l.exports.useContext(R),a=ee(),s=n.sort((r,i)=>b.getTimeStampByDate(i.createdAt)-b.getTimeStampByDate(r.createdAt)).sort((r,i)=>{var o,u;return b.getTimeStampByDate((o=i.pinnedAt)!=null?o:0)-b.getTimeStampByDate((u=r.pinnedAt)!=null?u:0)});return l.exports.useEffect(()=>{$.getMyAllQueries().catch(()=>{}).finally(()=>{a.setFinish()})},[]),c("div",{className:"queries-wrapper",children:[c("p",{className:"title-text",children:[t("span",{className:"normal-text",children:"\u5FEB\u901F\u68C0\u7D22"}),t("span",{className:"btn",onClick:()=>Ce(),children:"+"})]}),t(q,{when:a.isSucceed&&s.length===0,children:t("div",{className:"create-query-btn-container",children:t("span",{className:"btn",onClick:()=>Ce(),children:"\u521B\u5EFA\u68C0\u7D22"})})}),t("div",{className:"queries-container",children:s.map(r=>t(Jt,{query:r,isActive:r.id===e},r.id))})]})},Jt=n=>{const{query:e,isActive:a}=n,[s,r]=Z(!1),i=()=>{a?A.setMemoFilter(""):(["/","/recycle"].includes(A.getState().pathname)||A.setPathname("/"),A.setMemoFilter(e.id))},o=async N=>{if(N.stopPropagation(),s)try{await $.deleteQuery(e.id)}catch(h){w.error(h.message)}else r()},u=N=>{N.stopPropagation(),Ce(e.id)},p=async N=>{N.stopPropagation();try{e.pinnedAt?(await $.unpinQuery(e.id),$.editQuery(F(x({},e),{pinnedAt:void 0}))):(await $.pinQuery(e.id),$.editQuery(F(x({},e),{pinnedAt:b.getDateTimeString(Date.now())})))}catch{}},E=N=>{N.stopPropagation(),r(!1)};return t(O,{children:c("div",{className:`query-item-container ${a?"active":""}`,onClick:i,children:[c("div",{className:"query-text-container",children:[t("span",{className:"icon-text",children:"#"}),t("span",{className:"query-text",children:e.title})]}),c("div",{className:"btns-container",children:[t("span",{className:"action-btn toggle-btn",children:t("img",{className:"icon-img",src:`/icons/more${a?"-white":""}.svg`})}),t("div",{className:"action-btns-wrapper",children:c("div",{className:"action-btns-container",children:[t("span",{className:"btn",onClick:p,children:e.pinnedAt?"\u53D6\u6D88\u7F6E\u9876":"\u7F6E\u9876"}),t("span",{className:"btn",onClick:u,children:"\u7F16\u8F91"}),t("span",{className:`btn delete-btn ${s?"final-confirm":""}`,onClick:o,onMouseLeave:E,children:s?"\u786E\u5B9A\u5220\u9664\uFF01":"\u5220\u9664"})]})})]})]})})};const Xt=()=>{const{locationState:{query:{tag:n}},memoState:{tags:e,memos:a}}=l.exports.useContext(R),[s,r]=l.exports.useState([]);return l.exports.useEffect(()=>{I.updateTagsState()},[a]),l.exports.useEffect(()=>{const i=Array.from(e).sort(),o={subTags:[]};for(const u of i){const p=u.split("/");let E=o,N="";for(let h=0;h<p.length;h++){const m=p[h];h===0?N+=m:N+="/"+m;let d=null;for(const y of E.subTags)if(y.text===N){d=y;break}d||(d={key:m,text:N,subTags:[]},E.subTags.push(d)),E=d}}r(o.subTags)},[e]),c("div",{className:"tags-wrapper",children:[t("p",{className:"title-text",children:"\u5E38\u7528\u6807\u7B7E"}),c("div",{className:"tags-container",children:[s.map((i,o)=>t(Te,{tag:i,tagQuery:n},i.text+"-"+o)),t(q,{when:s.length<5&&I.initialized,children:c("p",{className:"tag-tip-container",children:["\u8F93\u5165",t("span",{className:"code-text",children:"# Tag "}),"\u6765\u521B\u5EFA\u6807\u7B7E\u5427~"]})})]})]})},Te=n=>{const{tag:e,tagQuery:a}=n,s=a===e.text,r=e.subTags.length>0,[i,o]=Z(!1),u=()=>{s?A.setTagQuery(""):(b.copyTextToClipboard(`# ${e.text} `),["/","/recycle"].includes(A.getState().pathname)||A.setPathname("/"),A.setTagQuery(e.text))},p=E=>{E.stopPropagation(),o()};return c(O,{children:[c("div",{className:`tag-item-container ${s?"active":""}`,onClick:u,children:[c("div",{className:"tag-text-container",children:[t("span",{className:"icon-text",children:"#"}),t("span",{className:"tag-text",children:e.key})]}),t("div",{className:"btns-container",children:r?t("span",{className:`action-btn toggle-btn ${i?"shown":""}`,onClick:p,children:t("img",{className:"icon-img",src:"/icons/arrow-right.svg"})}):null})]}),r?t("div",{className:`subtags-container ${i?"":"hidden"}`,children:e.subTags.map((E,N)=>t(Te,{tag:E,tagQuery:a},E.text+"-"+N))}):null]})};const ke={width:12,height:7},Ae=(n,e)=>{const a=[];for(let s=1;s<=n;s++)a.push({timestamp:e+V*s,count:0});return a},Zt=()=>{const n=b.getDateStampByDate(Date.now()),e=new Date(n).getDay()||7,a=new Array(7-e).fill(0),s=(ke.width-1)*ke.height+e,r=n-s*V,{memoState:{memos:i}}=l.exports.useContext(R),[o,u]=l.exports.useState(Ae(s,r)),[p,E]=l.exports.useState(null),[N,h]=l.exports.useState(null),m=l.exports.useRef(null),d=l.exports.useRef(null);l.exports.useEffect(()=>{const f=Ae(s,r);for(const C of i){const v=(b.getDateStampByDate(C.createdAt)-r)/(1e3*3600*24)-1;v>=0&&(f[v].count+=1)}u([...f])},[i]);const y=l.exports.useCallback((f,C)=>{var j,M;if(E(C),!d.current)return;const{isMobileView:v}=Q.getState(),D=f.target,k=document.querySelector(".sidebar-wrapper");d.current.style.left=D.offsetLeft-((M=(j=m.current)==null?void 0:j.offsetLeft)!=null?M:0)+"px";let U=D.offsetTop;v||(U-=k.scrollTop),d.current.style.top=U+"px"},[]),g=l.exports.useCallback(()=>{E(null)},[]),S=l.exports.useCallback(f=>{var C;((C=A.getState().query.duration)==null?void 0:C.from)===f.timestamp?(A.setFromAndToQuery(0,0),h(null)):f.count>0&&(["/","/recycle"].includes(A.getState().pathname)||A.setPathname("/"),A.setFromAndToQuery(f.timestamp,f.timestamp+V),h(f))},[]);return c("div",{className:"usage-heat-map-wrapper",ref:m,children:[c("div",{className:"day-tip-text-container",children:[t("span",{className:"tip-text",children:"Mon"}),t("span",{className:"tip-text"}),t("span",{className:"tip-text",children:"Wed"}),t("span",{className:"tip-text"}),t("span",{className:"tip-text",children:"Fri"}),t("span",{className:"tip-text"}),t("span",{className:"tip-text",children:"Sun"})]}),c("div",{ref:d,className:"usage-detail-container pop-up "+(p?"":"hidden"),children:[p==null?void 0:p.count," memos on ",t("span",{className:"date-text",children:new Date(p==null?void 0:p.timestamp).toDateString()})]}),c("div",{className:"usage-heat-map",children:[o.map((f,C)=>{const v=f.count,D=v<=0?"":v<=1?"stat-day-L1-bg":v<=2?"stat-day-L2-bg":v<=4?"stat-day-L3-bg":"stat-day-L4-bg";return t("span",{className:`stat-container ${D} ${N===f?"current":""} ${n===f.timestamp?"today":""}`,onMouseEnter:k=>y(k,f),onMouseLeave:g,onClick:()=>S(f)},C)}),a.map((f,C)=>t("span",{className:"stat-container null"},C))]})]})};const Be=()=>{const n=document.querySelector(se);n==null||n.classList.remove(re)},en=()=>{const{locationState:n}=l.exports.useContext(R);l.exports.useEffect(()=>{Be()},[n]);const e=l.exports.useCallback(a=>{a.stopPropagation(),a.target&&a.target.className==="sidebar-wrapper"&&Be()},[]);return c("aside",{className:"sidebar-wrapper",onClick:e,children:[t($t,{}),t(Zt,{}),t(zt,{}),t(Xt,{})]})};function tn(){const{locationState:{pathname:n}}=l.exports.useContext(R),e=ee();return l.exports.useEffect(()=>{const{user:a}=_.getState();a?e.setFinish():_.doSignIn().catch(()=>{}).finally(()=>{_.getState().user?e.setFinish():A.replaceHistory("/signin")})},[]),t(O,{children:e.isLoading?null:c("section",{id:"page-wrapper",children:[t(en,{}),t("main",{className:"content-wrapper",children:wn(n)})]})})}const nn=/[\u3000\u3400-\u4DBF\u4E00-\u9FFF]/;function le(n,e){return e.minLength!==void 0&&n.length<e.minLength?{result:!1,reason:"\u957F\u5EA6\u8FC7\u77ED"}:e.maxLength!==void 0&&n.length>e.maxLength?{result:!1,reason:"\u957F\u5EA6\u8D85\u51FA"}:e.noSpace&&n.includes(" ")?{result:!1,reason:"\u4E0D\u5E94\u542B\u6709\u7A7A\u683C"}:e.noChinese&&nn.test(n)?{result:!1,reason:"\u4E0D\u5E94\u542B\u6709\u4E2D\u6587\u5B57\u7B26"}:{result:!0}}const Ie={minLength:4,maxLength:24,noSpace:!0,noChinese:!0},an=()=>{const[n,e]=l.exports.useState(""),[a,s]=l.exports.useState(""),[r,i]=l.exports.useState(!0),o=ee(!1),u=l.exports.useRef(null),p=l.exports.useRef(null);l.exports.useEffect(()=>{const g=S=>{var f,C;S.key==="Enter"&&((f=u.current)==null||f.click(),(C=p.current)==null||C.click())};return document.body.addEventListener("keypress",g),()=>{document.body.removeEventListener("keypress",g)}},[]);const E=g=>{const S=g.target.value;e(S)},N=g=>{const S=g.target.value;s(S)},h=()=>{Fe()},m=async()=>{if(o.isLoading)return;const g=le(n,Ie);if(!g.result){w.error("\u7528\u6237\u540D "+g.reason);return}const S=le(a,Ie);if(!S.result){w.error("\u5BC6\u7801 "+S.reason);return}try{o.setLoading();const f=L.signin,{succeed:C,message:v}=await f(n,a);if(!C&&v){w.error("\u{1F61F} "+v);return}await _.doSignIn()?A.replaceHistory("/"):w.error("\u{1F61F} \u767B\u5F55\u5931\u8D25")}catch(f){console.error(f),w.error("\u{1F61F} "+f.message)}o.setFinish()},d=()=>{o.isLoading||i(!1)},y=async()=>{if(!o.isLoading){try{o.setLoading();const{succeed:g,message:S}=await L.signin("guest","123456");if(!g&&S){w.error("\u{1F61F} "+S);return}await _.doSignIn()?A.replaceHistory("/"):w.error("\u{1F61F} \u767B\u5F55\u5931\u8D25")}catch(g){console.error(g),w.error("\u{1F61F} "+g.message)}o.setFinish()}};return t("div",{className:"page-wrapper signin",children:c("div",{className:"page-container",children:[t("div",{className:"page-header-container",children:c("p",{className:"title-text",children:["\u767B\u5F55 Memos ",t("span",{className:"icon-text",children:"\u270D\uFE0F"})]})}),r?c(O,{children:[c("div",{className:"quickly-btns-container",children:[t("div",{ref:u,className:`btn guest-signin ${o.isLoading?"requesting":""}`,onClick:y,children:"\u4EE5\u6E38\u5BA2\u8D26\u53F7\u5FEB\u901F\u767B\u5F55"}),t("div",{className:`btn ${o.isLoading?"requesting":""}`,onClick:d,children:"\u5DF2\u6709\u8D26\u53F7\uFF0C\u6211\u8981\u81EA\u5DF1\u767B\u5F55"})]}),t("p",{className:"tip-text",children:c("span",{className:"btn",onClick:h,children:[t("span",{className:"icon-text",children:"\u{1F920}"}),"\u5173\u4E8E\u672C\u7AD9"]})})]}):c(O,{children:[c("div",{className:"page-content-container",children:[c("div",{className:"form-item-container input-form-container",children:[t("span",{className:"normal-text "+(n===""?"":"not-null"),children:"\u8D26\u53F7"}),t("input",{type:"text",autoComplete:"off",value:n,onChange:E})]}),c("div",{className:"form-item-container input-form-container",children:[t("span",{className:"normal-text "+(a===""?"":"not-null"),children:"\u5BC6\u7801"}),t("input",{type:"password",autoComplete:"off",value:a,onChange:N})]})]}),c("div",{className:"page-footer-container",children:[t("div",{className:"btns-container",children:window.location.origin.includes("justsven.top")?t("a",{className:"btn-text",href:"https://github.com/login/oauth/authorize?client_id=187ba36888f152b06612&scope=read:user,gist",children:"Sign In with GitHub"}):null}),c("div",{className:"btns-container",children:[t("button",{className:"btn signup-btn disabled",onClick:()=>w.info("\u6CE8\u518C\u5DF2\u5173\u95ED"),children:"\u6CE8\u518C"}),t("span",{className:"split-text",children:"/"}),t("button",{className:`btn signin-btn ${o.isLoading?"requesting":""}`,ref:p,onClick:m,children:"\u767B\u5F55"})]})]}),c("p",{className:"tip-text",children:["\u4EC5\u7528\u4E8E\u4F5C\u54C1\u5C55\u793A\uFF0C\u53EF\u8F93\u5165 ",t("code",{children:"guest, 123456"})," \u8FDB\u884C\u4F53\u9A8C\u3002",t("br",{}),c("span",{className:"btn",onClick:h,children:[t("span",{className:"icon-text",children:"\u{1F920}"}),"\u5173\u4E8E\u672C\u7AD9"]})]})]})]})})},sn={"/signin":t(an,{}),"*":t(tn,{})};function rn(){const[n,e]=l.exports.useState(!1);return l.exports.useCallback(()=>{e(s=>!s)},[])}const on=l.exports.forwardRef((n,e)=>{var C,v;const{className:a,initialContent:s,placeholder:r,showConfirmBtn:i,showCancelBtn:o,showTools:u,onConfirmBtnClick:p,onCancelBtnClick:E,onContentChange:N}=n,h=l.exports.useRef(null),m=l.exports.useRef({}),d=rn();l.exports.useEffect(()=>{s&&(h.current.value=s,d());const{tinyUndoActionsCache:D,tinyUndoIndexCache:k}=Y.get(["tinyUndoActionsCache","tinyUndoIndexCache"]);return m.current=new je(h.current,{initialActions:D,initialIndex:k}),m.current.subscribe((U,j)=>{Y.set({tinyUndoActionsCache:U,tinyUndoIndexCache:j})}),()=>{m.current.destroy()}},[]),l.exports.useEffect(()=>{var D;h.current&&(h.current.style.height="auto",h.current.style.height=((D=h.current.scrollHeight)!=null?D:0)+"px")},[(C=h.current)==null?void 0:C.value]),l.exports.useImperativeHandle(e,()=>({focus:()=>{h.current.focus()},insertText:D=>{const k=h.current.value;h.current.value=k+D,N(h.current.value),d()},setContent:D=>{h.current.value=D,d()},getContent:()=>{var D,k;return(k=(D=h.current)==null?void 0:D.value)!=null?k:""}}),[]);const y=l.exports.useCallback(()=>{N(h.current.value),d()},[]),g=l.exports.useCallback(D=>{D.stopPropagation(),D.code==="Enter"&&(D.metaKey||D.ctrlKey)&&S(),d()},[]),S=l.exports.useCallback(()=>{p(h.current.value),h.current.value="",d(),m.current.resetState()},[]),f=l.exports.useCallback(()=>{E()},[]);return c("div",{className:"common-editor-wrapper "+a,children:[t("textarea",{className:"common-editor-inputer",rows:1,placeholder:r,ref:h,onInput:y,onKeyDown:g}),c("div",{className:"common-tools-wrapper",children:[t(q,{when:u,children:t("div",{className:"common-tools-container"})}),c("div",{className:"btns-right-container",children:[t(q,{when:o,children:t("button",{className:"action-btn cancel-btn",onClick:f,children:"\u64A4\u9500\u4FEE\u6539"})}),t(q,{when:i,children:c("button",{className:"action-btn confirm-btn",disabled:!((v=h.current)==null?void 0:v.value),onClick:S,children:["\u8BB0\u4E0B",t("span",{className:"icon-text",children:"\u270D\uFE0F"})]})})]})]})]})});const cn=()=>{const{globalState:n}=l.exports.useContext(R),e=l.exports.useRef(null),a=l.exports.useRef(n);l.exports.useEffect(()=>{var p,E,N,h,m;if(n.markMemoId){const y=`${((p=e.current)==null?void 0:p.getContent())?`
`:""}Mark: [@MEMO](${n.markMemoId})`;(E=e.current)==null||E.insertText(y),Q.setMarkMemoId("")}if(n.editMemoId&&n.editMemoId!==a.current.editMemoId){const d=I.getMemoById(n.editMemoId);d&&((h=e.current)==null||h.setContent((N=d.content)!=null?N:""),(m=e.current)==null||m.focus())}a.current=n},[n.markMemoId,n.editMemoId]);const s=l.exports.useCallback(async p=>{if(p===""){w.error("\u5185\u5BB9\u4E0D\u80FD\u4E3A\u7A7A\u5440");return}const{editMemoId:E}=Q.getState();p=p.replaceAll("&nbsp;"," ");try{if(E){const N=I.getMemoById(E);if(N&&N.content!==p){const h=await I.updateMemo(N.id,p);h.updatedAt=b.getDateTimeString(Date.now()),I.editMemo(h)}Q.setEditMemoId("")}else{const N=await I.createMemo(p);I.pushMemo(N),A.clearQuery()}}catch(N){w.error(N.message)}Se("")},[]),r=l.exports.useCallback(()=>{var p;Q.setEditMemoId(""),(p=e.current)==null||p.setContent(""),Se("")},[]),i=l.exports.useCallback(p=>{const E=document.createElement("div");E.innerHTML=p,E.innerText.trim()===""&&(p=""),Se(p)},[]),{editMemoId:o}=n,u=l.exports.useMemo(()=>({className:"memo-editor",initialContent:ln(),placeholder:"\u73B0\u5728\u7684\u60F3\u6CD5\u662F...",showConfirmBtn:!0,showCancelBtn:o!=="",showTools:!0,onConfirmBtnClick:s,onCancelBtnClick:r,onContentChange:i}),[o]);return c("div",{className:"memo-editor-wrapper "+(o?"edit-ing":""),children:[t("p",{className:"tip-text "+(o?"":"hidden"),children:"\u6B63\u5728\u4FEE\u6539\u4E2D..."}),t(on,x({ref:e},u))]})};function ln(){var n;return(n=Y.get(["editorContentCache"]).editorContentCache)!=null?n:""}function Se(n){Y.set({editorContentCache:n})}const un=()=>{const{locationState:{query:{type:n}}}=l.exports.useContext(R),e=s=>{const{type:r}=A.getState().query;s===r&&(s=""),A.setMemoTypeQuery(s)};return c("div",{className:"search-bar-container",children:[c("div",{className:"search-bar-inputer",children:[t("img",{className:"icon-img",src:"/icons/search.svg"}),t("input",{className:"text-input",type:"text",placeholder:"",onChange:s=>{const r=s.currentTarget.value;A.setTextQuery(r)}})]}),t("div",{className:"quickly-action-wrapper",children:c("div",{className:"quickly-action-container",children:[t("p",{className:"title-text",children:"QUICKLY FILTER"}),c("div",{className:"section-container types-container",children:[t("span",{className:"section-text",children:"\u7C7B\u578B:"}),t("div",{className:"values-container",children:Ne.map((s,r)=>c("div",{children:[t("span",{className:`type-item ${n===s.value?"selected":""}`,onClick:()=>{e(s.value)},children:s.text}),r+1<Ne.length?t("span",{className:"split-text",children:"/"}):null]},s.value))})]})]})})]})};let Oe=Date.now();const dn=()=>{const{locationState:{query:{filter:n}},globalState:{isMobileView:e},queryState:{queries:a}}=l.exports.useContext(R),[s,r]=l.exports.useState("MEMOS");l.exports.useEffect(()=>{const u=$.getQueryById(n);r(u?u.title:"MEMOS")},[n,a]);const i=l.exports.useCallback(()=>{const u=Date.now();u-Oe>10*1e3&&(Oe=u,I.fetchAllMemos().catch(()=>{}))},[]),o=l.exports.useCallback(u=>{u.stopPropagation();const p=document.querySelector(se);p&&p.classList.add(re)},[]);return c("div",{className:"section-header-container memos-header-container",children:[c("div",{className:"title-text",onClick:i,children:[t(q,{when:e,children:t("button",{className:"action-btn",onClick:o,children:t("img",{className:"icon-img",src:"/icons/menu.svg",alt:"menu"})})}),t("span",{className:"normal-text",children:s})]}),t(un,{})]})};const Le=()=>{const{locationState:{query:n}}=l.exports.useContext(R),{tag:e,duration:a,type:s,text:r,filter:i}=n,o=$.getQueryById(i),u=Boolean(e||a&&a.from<a.to||s||r||o);return c("div",{className:`filter-query-container ${u?"":"hidden"}`,children:[t("span",{className:"tip-text",children:"\u7B5B\u9009\uFF1A"}),c("div",{className:"filter-item-container "+(o?"":"hidden"),onClick:()=>{A.setMemoFilter("")},children:[t("span",{className:"icon-text",children:"\u{1F516}"})," ",o==null?void 0:o.title]}),c("div",{className:"filter-item-container "+(e?"":"hidden"),onClick:()=>{A.setTagQuery("")},children:[t("span",{className:"icon-text",children:"\u{1F3F7}\uFE0F"})," ",e]}),c("div",{className:"filter-item-container "+(s?"":"hidden"),onClick:()=>{A.setMemoTypeQuery("")},children:[t("span",{className:"icon-text",children:"\u{1F4E6}"})," ",Gt(s)]}),a&&a.from<a.to?c("div",{className:"filter-item-container",onClick:()=>{A.setFromAndToQuery(0,0)},children:[t("span",{className:"icon-text",children:"\u{1F5D3}\uFE0F"})," ",b.getDateString(a.from)," \u81F3 ",b.getDateString(a.to)]}):null,c("div",{className:"filter-item-container "+(r?"":"hidden"),onClick:()=>{A.setTextQuery("")},children:[t("span",{className:"icon-text",children:"\u{1F50D}"})," ",r]})]})};const mn=()=>{const{locationState:{query:n},memoState:{memos:e}}=l.exports.useContext(R),[a,s]=l.exports.useState(!0),r=l.exports.useRef(null),{tag:i,duration:o,type:u,text:p,filter:E}=n,N=Boolean(i||o&&o.from<o.to||u||p),h=N||E?e.filter(d=>{let y=!0;const g=$.getQueryById(E);if(g){const S=JSON.parse(g.querystring);Array.isArray(S)&&(y=Ee(d,S))}return i&&!d.content.includes(`# ${i}`)&&(y=!1),o&&o.from<o.to&&(b.getTimeStampByDate(d.createdAt)<o.from||b.getTimeStampByDate(d.createdAt)>o.to)&&(y=!1),u&&(u==="NOT_TAGGED"&&d.content.match(X)!==null||u==="LINKED"&&d.content.match(ie)===null||u==="IMAGED"&&d.content.match(W)===null||u==="CONNECTED"&&d.content.match(oe)===null)&&(y=!1),p&&!d.content.includes(p)&&(y=!1),y}):e;l.exports.useEffect(()=>{I.fetchAllMemos().then(()=>{s(!1)}).catch(()=>{w.error("\u{1F62D} \u8BF7\u6C42\u6570\u636E\u5931\u8D25\u4E86")})},[]),l.exports.useEffect(()=>{var d;(d=r.current)==null||d.scrollTo({top:0})},[n]);const m=l.exports.useCallback(d=>{const y=d.target;if(y.tagName==="SPAN"&&y.className==="tag-span"){const g=y.innerText.slice(1);A.getState().query.tag===g?A.setTagQuery(""):A.setTagQuery(g)}},[]);return c("div",{className:`memolist-wrapper ${a?"":"completed"}`,onClick:m,ref:r,children:[h.map(d=>t(It,{memo:d},`${d.id}-${d.updatedAt}`)),t("div",{className:"status-text-container",children:t("p",{className:"status-text",children:a?"\u52AA\u529B\u8BF7\u6C42\u6570\u636E\u4E2D...":h.length===0?"\u7A7A\u7A7A\u5982\u4E5F":N?"":"\u6240\u6709\u6570\u636E\u52A0\u8F7D\u5B8C\u5566 \u{1F389}"})})]})};function pn(){return c(O,{children:[t(dn,{}),t(cn,{}),t(Le,{}),t(mn,{})]})}const hn=n=>{var N,h;const{memo:e,handleDeletedMemoAction:a}=n,s=F(x({},e),{createdAtStr:b.getDateTimeString(e.createdAt),deletedAtStr:b.getDateTimeString((N=e.deletedAt)!=null?N:Date.now())}),[r,i]=Z(!1),o=Array.from((h=s.content.match(W))!=null?h:[]),u=async()=>{if(r)try{await I.deleteMemoById(s.id),a(s.id)}catch(m){w.error(m.message)}else i()},p=async()=>{try{await I.restoreMemoById(s.id),a(s.id),w.info("\u6062\u590D\u6210\u529F")}catch(m){w.error(m.message)}},E=()=>{r&&i(!1)};return c("div",{className:`memo-wrapper ${"memos-"+s.id}`,onMouseLeave:E,children:[c("div",{className:"memo-top-wrapper",children:[c("span",{className:"time-text",children:["\u5220\u9664\u4E8E ",s.deletedAtStr]}),c("div",{className:"btns-container",children:[t("span",{className:"btn more-action-btn",children:t("img",{className:"icon-img",src:"/icons/more.svg"})}),t("div",{className:"more-action-btns-wrapper",children:c("div",{className:"more-action-btns-container",children:[t("span",{className:"btn restore-btn",onClick:p,children:"\u6062\u590D"}),t("span",{className:`btn delete-btn ${r?"final-confirm":""}`,onClick:u,children:r?"\u786E\u5B9A\u5220\u9664\uFF01":"\u5B8C\u5168\u5220\u9664"})]})})]})]}),t("div",{className:"memo-content-text",dangerouslySetInnerHTML:{__html:z(s.content)}}),t(q,{when:o.length>0,children:t("div",{className:"images-wrapper",children:o.map((m,d)=>t(fe,{className:"memo-img",imgUrl:m},d))})})]})};const gn=()=>{const{locationState:{query:n},globalState:{isMobileView:e}}=l.exports.useContext(R),a=ee(),[s,r]=l.exports.useState([]),{tag:i,duration:o,type:u,text:p,filter:E}=n,N=$.getQueryById(E),m=Boolean(i||o&&o.from<o.to||u||p||N)||N?s.filter(g=>{let S=!0;if(N){const f=JSON.parse(N.querystring);Array.isArray(f)&&(S=Ee(g,f))}return i&&!g.content.includes(`# ${i}`)&&(S=!1),o&&o.from<o.to&&(b.getTimeStampByDate(g.createdAt)<o.from||b.getTimeStampByDate(g.createdAt)>o.to)&&(S=!1),u&&(u==="NOT_TAGGED"&&g.content.match(X)!==null||u==="LINKED"&&g.content.match(ie)===null||u==="IMAGED"&&g.content.match(W)===null||u==="CONNECTED"&&g.content.match(oe)===null)&&(S=!1),p&&!g.content.includes(p)&&(S=!1),S}):s;l.exports.useEffect(()=>{I.fetchAllMemos(),I.fetchDeletedMemos().then(g=>{g!==!1&&r(g)}).catch(g=>{w.error("Failed to fetch deleted memos: ",g)}).finally(()=>{a.setFinish()}),A.clearQuery()},[]);const d=l.exports.useCallback(g=>{r(S=>S.filter(f=>f.id!==g))},[]),y=l.exports.useCallback(g=>{g.stopPropagation();const S=document.querySelector(se);S&&S.classList.add(re)},[]);return c("div",{className:"memo-trash-wrapper",children:[t("div",{className:"section-header-container",children:c("div",{className:"title-text",children:[t(q,{when:e,children:t("button",{className:"action-btn",onClick:y,children:t("img",{className:"icon-img",src:"/icons/menu.svg",alt:"menu"})})}),t("span",{className:"normal-text",children:"\u56DE\u6536\u7AD9"})]})}),t(Le,{}),a.isLoading?t("div",{className:"tip-text-container",children:t("p",{className:"tip-text",children:"\u52AA\u529B\u8BF7\u6C42\u6570\u636E\u4E2D..."})}):s.length===0?t("div",{className:"tip-text-container",children:t("p",{className:"tip-text",children:"Here is No Zettels."})}):t("div",{className:"deleted-memos-container",children:m.map(g=>t(hn,{memo:g,handleDeletedMemoAction:d},`${g.id}-${g.updatedAt}`))})]})};const fn={minLength:4,maxLength:24,noSpace:!0,noChinese:!0},yn=({destroy:n})=>{const[e,a]=l.exports.useState(""),[s,r]=l.exports.useState(""),[i,o]=l.exports.useState("");l.exports.useEffect(()=>{},[]);const u=()=>{n()},p=m=>{const d=m.target.value;a(d)},E=m=>{const d=m.target.value;r(d)},N=m=>{const d=m.target.value;o(d)},h=async()=>{if(e===""||s===""||i===""){w.error("\u5BC6\u7801\u4E0D\u80FD\u4E3A\u7A7A");return}if(s!==i){w.error("\u65B0\u5BC6\u7801\u4E24\u6B21\u8F93\u5165\u4E0D\u4E00\u81F4"),o("");return}const m=le(s,fn);if(!m.result){w.error("\u5BC6\u7801 "+m.reason);return}try{if(!await _.checkPasswordValid(e)){w.error("\u65E7\u5BC6\u7801\u4E0D\u5339\u914D"),a("");return}await _.updatePassword(s),w.info("\u5BC6\u7801\u4FEE\u6539\u6210\u529F\uFF01"),u()}catch(d){w.error(d)}};return c(O,{children:[c("div",{className:"dialog-header-container",children:[t("p",{className:"title-text",children:"\u4FEE\u6539\u5BC6\u7801"}),t("button",{className:"btn close-btn",onClick:u,children:t("img",{className:"icon-img",src:"/icons/close.svg"})})]}),c("div",{className:"dialog-content-container",children:[c("label",{className:"form-label input-form-label",children:[t("span",{className:"normal-text "+(e===""?"":"not-null"),children:"\u65E7\u5BC6\u7801"}),t("input",{type:"password",value:e,onChange:p})]}),c("label",{className:"form-label input-form-label",children:[t("span",{className:"normal-text "+(s===""?"":"not-null"),children:"\u65B0\u5BC6\u7801"}),t("input",{type:"password",value:s,onChange:E})]}),c("label",{className:"form-label input-form-label",children:[t("span",{className:"normal-text "+(i===""?"":"not-null"),children:"\u518D\u6B21\u8F93\u5165\u65B0\u5BC6\u7801"}),t("input",{type:"password",value:i,onChange:N})]}),c("div",{className:"btns-container",children:[t("span",{className:"btn cancel-btn",onClick:u,children:"\u53D6\u6D88"}),t("span",{className:"btn confirm-btn",onClick:h,children:"\u4FDD\u5B58"})]})]})]})};function Nn(){K({className:"change-password-dialog"},yn)}const En=({destroy:n})=>{const[e,a]=l.exports.useState("");l.exports.useEffect(()=>{},[]);const s=()=>{n()},r=o=>{const u=o.target.value;a(u)},i=async()=>{if(e===""){w.error("\u5FAE\u4FE1 id \u4E0D\u80FD\u4E3A\u7A7A");return}try{await _.updateWxUserId(e),_.doSignIn(),w.info("\u7ED1\u5B9A\u6210\u529F\uFF01"),s()}catch(o){w.error(o)}};return c(O,{children:[c("div",{className:"dialog-header-container",children:[t("p",{className:"title-text",children:"\u7ED1\u5B9A\u5FAE\u4FE1 OpenID"}),t("button",{className:"btn close-btn",onClick:s,children:t("img",{className:"icon-img",src:"/icons/close.svg"})})]}),c("div",{className:"dialog-content-container",children:[c("p",{className:"tip-text",children:["\u5173\u6CE8\u5FAE\u4FE1\u516C\u4F17\u53F7\u201C\u5C0F\u8C08\u95F2\u4E8B\u201D\uFF0C\u4E3B\u52A8\u53D1\u9001\u4EFB\u610F\u6D88\u606F\uFF0C\u5373\u53EF\u83B7\u53D6 ",t("strong",{children:"OpenID"})," \u3002"]}),c("label",{className:"form-label input-form-label",children:[t("span",{className:"normal-text "+(e===""?"":"not-null"),children:"\u5FAE\u4FE1 OpenID"}),t("input",{type:"text",value:e,onChange:r})]}),c("div",{className:"btns-container",children:[t("span",{className:"btn cancel-btn",onClick:s,children:"\u53D6\u6D88"}),t("span",{className:"btn confirm-btn",onClick:i,children:"\u4FDD\u5B58"})]})]})]})};function Cn(){K({className:"bind-wxid-dialog"},En)}const Sn={minLength:4,maxLength:24,noSpace:!0,noChinese:!0},xn=()=>{const{userState:n}=l.exports.useContext(R),e=n.user,[a,s]=l.exports.useState(e.username),[r,i]=l.exports.useState(!1),[o,u]=l.exports.useState(!1),[p,E]=l.exports.useState(!1),N=S=>{const f=S.target.value;s(f)},h=async()=>{if(e.username==="guest"){w.info("\u{1F232} \u4E0D\u8981\u4FEE\u6539\u6211\u7684\u7528\u6237\u540D");return}if(a===e.username){i(!1);return}const S=le(a,Sn);if(!S.result){w.error("\u7528\u6237\u540D "+S.reason);return}try{if(!await _.checkUsernameUsable(a)){w.error("\u7528\u6237\u540D\u65E0\u6CD5\u4F7F\u7528");return}await _.updateUsername(a),await _.doSignIn(),i(!1),w.info("\u4FEE\u6539\u6210\u529F~")}catch(f){w.error(f.message)}},m=()=>{if(e.username==="guest"){w.info("\u{1F232} \u4E0D\u8981\u4FEE\u6539\u6211\u7684\u5BC6\u7801");return}Nn()},d=async()=>{if(o){try{await _.removeGithubName(),await _.doSignIn()}catch(S){w.error(S.message)}u(!1)}else u(!0)},y=async()=>{if(p){try{await _.updateWxUserId(""),await _.doSignIn()}catch(S){w.error(S.message)}E(!1)}else E(!0)},g=S=>{S.preventDefault()};return c(O,{children:[c("div",{className:"section-container account-section-container",children:[t("p",{className:"title-text",children:"\u57FA\u672C\u4FE1\u606F"}),c("label",{className:"form-label input-form-label",children:[t("span",{className:"normal-text",children:"ID\uFF1A"}),t("span",{className:"normal-text",children:e.id})]}),c("label",{className:"form-label input-form-label",children:[t("span",{className:"normal-text",children:"\u521B\u5EFA\u65F6\u95F4\uFF1A"}),t("span",{className:"normal-text",children:b.getDateString(e.createdAt)})]}),c("label",{className:"form-label input-form-label username-label",children:[t("span",{className:"normal-text",children:"\u8D26\u53F7\uFF1A"}),t("input",{type:"text",readOnly:!r,value:a,onClick:()=>{i(!0)},onChange:N}),c("div",{className:"btns-container",onClick:g,children:[t("span",{className:"btn confirm-btn "+(r?"":"hidden"),onClick:h,children:"\u4FDD\u5B58"}),t("span",{className:"btn cancel-btn "+(r?"":"hidden"),onClick:()=>{s(e.username),i(!1)},children:"\u64A4\u9500"})]})]}),c("label",{className:"form-label password-label",children:[t("span",{className:"normal-text",children:"\u5BC6\u7801\uFF1A"}),t("span",{className:"btn",onClick:m,children:"\u4FEE\u6539\u5BC6\u7801"})]})]}),c("div",{className:"section-container connect-section-container",children:[t("p",{className:"title-text",children:"\u5173\u8054\u8D26\u53F7"}),c("label",{className:"form-label input-form-label",children:[t("span",{className:"normal-text",children:"\u5FAE\u4FE1 OpenID\uFF1A"}),e.wxUserId?c(O,{children:[t("span",{className:"value-text",children:"************"}),t("span",{className:`btn-text unbind-btn ${p?"final-confirm":""}`,onMouseLeave:()=>E(!1),onClick:y,children:p?"\u786E\u5B9A\u53D6\u6D88\u7ED1\u5B9A\uFF01":"\u53D6\u6D88\u7ED1\u5B9A"})]}):c(O,{children:[t("span",{className:"value-text",children:"\u65E0"}),t("span",{className:"btn-text bind-btn",onClick:()=>{Cn()},children:"\u7ED1\u5B9A ID"})]})]}),c("label",{className:"form-label input-form-label",children:[t("span",{className:"normal-text",children:"GitHub\uFF1A"}),e.githubName?c(O,{children:[t("a",{className:"value-text",href:"https://github.com/"+e.githubName,children:e.githubName}),t("span",{className:`btn-text unbind-btn ${o?"final-confirm":""}`,onMouseLeave:()=>u(!1),onClick:d,children:o?"\u786E\u5B9A\u53D6\u6D88\u7ED1\u5B9A\uFF01":"\u53D6\u6D88\u7ED1\u5B9A"})]}):c(O,{children:[t("span",{className:"value-text",children:"\u65E0"}),t("a",{className:"btn-text link-btn",href:"https://github.com/login/oauth/authorize?client_id=187ba36888f152b06612&scope=read:user,gist",children:"\u524D\u5F80\u7ED1\u5B9A"})]})]})]})]})};const bn=()=>{const{globalState:n}=l.exports.useContext(R),{shouldHideImageUrl:e,shouldSplitMemoWord:a,shouldUseMarkdownParser:s}=n,r=`\u{1F44B} \u4F60\u597D\u5440\uFF5E
\u6211\u662F\u4E00\u4E2Ademo\uFF1A
* \u{1F44F} \u6B22\u8FCE\u4F7F\u7528memos\uFF1B`,i=()=>{Q.setAppSetting({shouldSplitMemoWord:!a})},o=()=>{Q.setAppSetting({shouldHideImageUrl:!e})},u=()=>{Q.setAppSetting({shouldUseMarkdownParser:!s})},p=async()=>{const N=I.getState().memos.map(d=>x({},d)),h=JSON.stringify(N),m=document.createElement("a");m.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(h)),m.setAttribute("download","data.json"),m.style.display="none",document.body.appendChild(m),m.click(),document.body.removeChild(m)},E=async()=>{const N=I.getState().memos;for(const h of N)I.updateMemo(h.id,ge(h.content))};return c(O,{children:[c("div",{className:"section-container preferences-section-container",children:[t("p",{className:"title-text",children:"Memo \u663E\u793A\u76F8\u5173"}),t("div",{className:"demo-content-container memo-content-text",dangerouslySetInnerHTML:{__html:z(r)}}),c("label",{className:"form-label checkbox-form-label",onClick:i,children:[t("span",{className:"normal-text",children:"\u4E2D\u82F1\u6587\u5185\u5BB9\u81EA\u52A8\u95F4\u9694"}),t("img",{className:"icon-img",src:a?"/icons/checkbox-active.svg":"/icons/checkbox.svg"})]}),c("label",{className:"form-label checkbox-form-label",onClick:u,children:[t("span",{className:"normal-text",children:"\u90E8\u5206 markdown \u683C\u5F0F\u89E3\u6790"}),t("img",{className:"icon-img",src:s?"/icons/checkbox-active.svg":"/icons/checkbox.svg"})]}),c("label",{className:"form-label checkbox-form-label",onClick:o,children:[t("span",{className:"normal-text",children:"\u9690\u85CF\u56FE\u7247\u94FE\u63A5\u5730\u5740"}),t("img",{className:"icon-img",src:e?"/icons/checkbox-active.svg":"/icons/checkbox.svg"})]})]}),c("div",{className:"section-container hidden",children:[t("p",{className:"title-text",children:"\u5176\u4ED6"}),c("div",{className:"btn-container",children:[t("button",{className:"btn export-btn",onClick:p,children:"\u5BFC\u51FA\u6570\u636E(JSON)"}),t("button",{className:"btn format-btn",onClick:E,children:"\u683C\u5F0F\u5316\u6570\u636E"})]})]})]})};const vn=()=>{const{globalState:{isMobileView:n}}=l.exports.useContext(R);l.exports.useEffect(()=>{I.fetchAllMemos()},[]);const e=l.exports.useCallback(a=>{a.stopPropagation();const s=document.querySelector(se);s&&s.classList.add(re)},[]);return c("div",{className:"preference-wrapper",children:[t("div",{className:"section-header-container",children:c("div",{className:"title-text",children:[t(q,{when:n,children:t("button",{className:"action-btn",onClick:e,children:t("img",{className:"icon-img",src:"/icons/menu.svg",alt:"menu"})})}),t("span",{className:"normal-text",children:"\u8D26\u53F7\u4E0E\u8BBE\u7F6E"})]})}),c("div",{className:"sections-wrapper",children:[t(xn,{}),t(bn,{})]})]})},Dn={"/recycle":t(gn,{}),"/setting":t(vn,{}),"*":t(pn,{})},_e=n=>e=>{for(const a of Object.keys(n))if(a===e)return n[a];return n["*"]},Fn=_e(sn),wn=_e(Dn);function Mn(){const{locationState:{pathname:n}}=l.exports.useContext(R);return l.exports.useEffect(()=>{const e=()=>{Q.setIsMobileView(document.body.clientWidth<=875)};return e(),window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[]),t(O,{children:Fn(n)})}(()=>{String.prototype.replaceAll||(String.prototype.replaceAll=function(n,e){return Object.prototype.toString.call(n).toLowerCase()==="[object regexp]"?this.replace(n,e):this.replace(new RegExp(n,"g"),e)})})();ae.render(t(Ve.StrictMode,{children:t(ve,{store:T,context:R,children:t(Mn,{})})}),document.getElementById("root"));
